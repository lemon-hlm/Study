
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1 ConfigMap概述](#1-configmap概述)
- [2 创建ConfigMap资源对象](#2-创建configmap资源对象)
  - [2.1 通过YAML配置文件方式创建](#21-通过yaml配置文件方式创建)

<!-- /code_chunk_output -->

**应用部署**的一个**最佳实践**是将**应用所需的配置信息！！！** 与**程序！！！** 进行**分离**，这样可以使**应用程序被更好地复用**，通过不同的配置也能实现更灵活的功能。

将**应用打包为容器镜像**后，可以通过**环境变量**或者**外挂文件的方式**在**创建容器时**进行**配置注入**，但在大规模容器集群的环境中，对**多个容器**进行**不同的配置**将变得非常复杂。

从Kubernetes 1.2开始提供了一种统一的应用配置管理方案—ConfigMap。

# 1 ConfigMap概述

ConfigMap供容器使用的典型用法如下.

（1）生成为**容器内的环境变量**。

（2）设置**容器启动命令的启动参数**（需设置为**环境变量**）。

（3）以Volume的形式**挂载为容器内部的文件或目录**。

ConfigMap以一个或多个key:value的形式保存在Kubernetes系统中供应用使用，既可以用于表示一个变量的值（例如apploglevel=info），也可以用于表示一个完整配置文件的内容（例如server.xml=\<?xml...>...）

可以通过**YAML配置文件**或者**直接使用kubectl create configmap命令行**的方式来创建ConfigMap。

# 2 创建ConfigMap资源对象

## 2.1 通过YAML配置文件方式创建

下面的例子cm\-appvars.yaml描述了将几个应用所需的变量定义为ConfigMap的用法：

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: cm-appvars
data:
  apploglevel: info
  appdatadir: /var/data
```

执行kubectl create命令创建该ConfigMap：

```
# kubectl create -f cm-appvars.yaml
configmap "cm-appvars" created
```

查看创建好的ConfigMap:

```
# kubectl get configmap
NAME        DATA    AGE
cm-appvars  2       3s

```

