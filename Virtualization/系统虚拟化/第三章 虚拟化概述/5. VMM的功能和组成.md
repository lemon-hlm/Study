从软件角度看, 物理机器是由处理器、内存和I/O设备等一组资源构成的实体. 虚拟机也一样, 由虚拟处理器、虚拟内存和虚拟I/O设备等组成。 

VMM基本上可以分为两部分: 虚拟环境的管理和物理资源的管理. 前一部分是所有VMM产品需要提供的基本功能, 后一部分根据实现结构的差异, 也各有差异.

# 1 虚拟环境的管理

## 1.1 虚拟资源

VMM需要提供如下基本模块.

⓵ 处理器虚拟化模块. 为虚拟机提供虚拟处理器.

⓶ 内存虚拟化模块. 为虚拟机提供虚拟内存

⓷ 设备虚拟化模块. 为虚拟机提供虚拟I/O设备.

## 1.2 虚拟环境的调度

操作系统调度的单位是进程/线程, VMM调度的调度单位是虚拟处理器. 当虚拟处理器被调度到时, VMM调度程序负责将虚拟处理器上下文装载到物理处理器上, 然后虚拟处理器所对应的客户机指令开始真正被执行. 当时间片用完或虚拟处理器主动让出, 调度程序被触发. 调度程序根据调度策略, 挑选下一个虚拟处理器继续运行.

VMM调度策略可以有多种, 例如平均分配时间片, 或按照虚拟机权重等.

## 1.3 虚拟机间通信机制

与OS中进程间通信类似, 虚拟环境下也存在虚拟机间通信机制. 虚拟机间通信机制为虚拟机互相通信的手段. 比如, 类虚拟化I/O中是基于事务的模型, 一个I/O事务需要