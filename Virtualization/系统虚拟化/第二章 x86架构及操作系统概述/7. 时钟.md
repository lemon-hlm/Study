现代计算机中, 操作系统中很多事件都是时钟驱动的, 例如进程调度、定时器等.

时钟根据**工作方式**不同, 可以分为如下两类.

⓵ 周期性时钟(Periodic Timer): 时钟以固定频率产生时钟中断. 通常, 周期性时钟会有一个计数器, 要么以固定值递减到0产生中断, 例如PIT; 要么固定增长, 当达到某个阙值时产生中断, 同时自动将阙值增加一个固定值, 计数器继续递增, 例如HPET.

⓶ 单次计时时钟(One\-shot Timer): 多数时钟都可以配置成这种方式, 例如PIT、HPET. 其工作方式和**到达阙值产生中断的周期性时钟**类似, 不同的是**产生中断后阙值不会自动增加**, 而是需要软件(通常是时钟中断处理函数)增加该阙值. 这提供给软件动态调整下一次时钟中断到来时间的能力, 使一些新技术,例如无滴答声内核(Tickles Kernel)的实现成为可能.

# 1 x86平台的常用时钟

由于历史原因, x86平台有多种时钟, 目前仍广泛使用的有以下几种.

(1) PIT(Programmable Interrupt Timer或Programmable Interval Timer, 可编程中断/间隔时钟): IBM PC平台产生, 频率为1000Hz左右, 即每次中断间隔约为1ms, 通常接IRQ0, 软件可以通过0x40\~0x43 I/O端口进行操作. PIT是一种低精度的时钟, 容易溢出(16位), 已渐渐被高精度时钟取代. PIT支持周期性和单次计时两种方式.

(2) RTC(Real Time Clock, 实时时钟): 通常和CMOS集成在一起, 由CMOS电池供电, 故能在关机后继续计时. 其频率范围是2\~8192Hz, 通常接IRQ8, 软件可以通过0x70\~0x71 I/O端口操作. RTC