
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

* [1 virt\-viewer](#1-virt-viewer)

<!-- /code_chunk_output -->

# 1 virt\-viewer

virt\-viewer是“Virtual Machine Viewer”（虚拟机查看器）工具的软件包和命令行工具名称，它是一个显示**虚拟化客户机的图形界面的工具**。

virt\-viewer使用**GTK\-VNC**或**SPICE\-GTK**作为它的显示能力，使用**libvirt API**去查询客户机的VNC或SPICE服务器端的信息。virt-viewer经常用于替换传统的VNC客户端查看器，因为后者通常不支持x509认证授权的SSL/TLS加密，而virt-viewer是支持的。在4.3节讲到的在virt-manager中查看客户机图形界面进行交互时，其实已经间接地使用过virt-viewer工具了。
在RHEL 7.3系统中查看virt-viewer的RPM包信息，命令行如下：

[root@kvm-host ~]# rpm -q virt-viewer￼ virt-viewer-2.0-11.el7.x86_64

virt-viewer的使用语法如下：

virt-viewer [OPTION...] -- DOMAIN-NAME|ID|UUID

virt-viewer连接到的客户机可以通过客户机的名称、域ID、UUID等表示来唯一指定。virt-viewer还支持“-c URI”或“--connection URI”参数来指定连接到远程宿主机上的一个客户机，当然远程连接时一些必要的认证还是必需的。关于virt-viewer工具更多详细的参数和解释，可以通过“man virt-viewer”命令查看使用手册。
在图形界面的一个终端中，用“virt-viewer centos7u2-1”连接到本地宿主机上名为“centos7u2-1”的客户机，其显示效果如图4-18所示。
￼
图4-18　virt-viewer连接到本地的一个客户机
在virt-viewer打开的客户机窗口中（见图4-18），其工具栏的“File”菜单下有保存屏幕快照的功能，“View”菜单下有使用全屏和放大（或缩小）屏幕的功能，“Send key”菜单下可以向客户机发送一些特殊的按键（如Ctrl+Alt+Del、Ctrl+Alt+F2等）。
4.4.2　virt-install
virt-install是“Virt Install”工具的命令名称和软件包名称（在RHEL 6.x系统中，包名是python-virtinst）。virt-install命令行工具为虚拟客户机的安装提供了一个便捷易用的方式，它也是用libvirt API来创建KVM、Xen、LXC等各种类型的客户机，同时，它也为virt-manager的图形界面创建客户机提供了安装系统的API。virt-install工具使用文本模式的串口控制台和VNC（或SPICE）图形接口，可以支持基于文本模式和图形界面的客户机安装。virt-install中使用到的安装介质（如光盘、ISO文件）可以存放在本地系统上，也可以存放在远程的NFS、HTTP、FTP服务器上。virt-install支持本地的客户机系统，也可以通过“--connect URI”（或“-c URI”）参数来支持在远程宿主机中安装客户机。使用virt-install中的一些选项（--initrd-inject、--extra-args等）和Kickstart￼文件，可以实现无人值守的自动化安装客户机系统。
在RHEL中，virt-install工具存在于“virt-install”RPM包中，查询的命令行如下：

[root@kvm-host ~]# rpm -q virt-install￼ virt-install-1.4.0-2.el7.noarch

使用virt-install命令启动一个客户机的安装过程，其命令行操作如下：

[root@kvm-host ~]# virt-install --connect qemu:///system --name centos7u2-3 --memory 1024 --disk path=/var/lib/libvirt/images/centos7u2-3.img,size=10 --network network:default --cdrom /var/lib/libvirt/images/CentOS7.2.iso --os-variant rhel7 --graphics vnc￼ ￼ Starting install...￼ Creating domain...                       |    0 B  00:00:00

上面virt-install的命令行参数中，“--connect”用于连接到本地或远程的Hypervisor（无该参数时，默认连接本地Hypervisor）；“--memory”用于配置客户机的内存大小（单位是MB）；“--disk”用于配置客户机的磁盘镜像文件，其中path属性表示路径，size属性表示磁盘大小（默认单位为GB）；“--cdrom”用于指定用于安装的ISO光盘镜像文件；“--os-variant rhel7”表示客户机是RHEL 7类型的系统（virt-install会根据这个值自动优化一些安装配置）；“--graphics vnc”表示使用VNC图形接口连接到客户机的控制台。关于virt-install工具的更多更详细参数配置，可以通过“man virt-install”命令查看相应的帮助文档。
在示例中使用VNC接口连接到客户机，会默认