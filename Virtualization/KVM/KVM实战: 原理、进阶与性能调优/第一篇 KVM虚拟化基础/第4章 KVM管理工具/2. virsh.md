
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

* [1 virsh简介](#1-virsh简介)

<!-- /code_chunk_output -->

# 1 virsh简介

**libvirt项目的源代码！！！**中就包含了**virsh**这个虚拟化管理工具的代码。virsh￼是用于管理虚拟化环境中的客户机和Hypervisor的命令行工具，与virt\-manager等工具类似，它也是通过**调用libvirt API**来实现虚拟化的管理的。virsh是完全在命令行文本模式下运行的用户态工具，它是系统管理员通过脚本程序实现虚拟化自动部署和管理的理想工具之一。

virsh是用C语言编写的一个使用libvirt API的虚拟化管理工具。**virsh程序**的**源代码**在libvirt项目源代码的**tools目录**下，实现virsh工具最核心的一个源代码文件是**virsh.c**，其路径如下：

```
[root@kvm-host ~]# cd libvirt-2.0.0￼
[root@kvm-host libvirt-2.0.0]# ls tools/virsh.c￼
tools/virsh.c
```

在使用**virsh命令行**进行虚拟化管理操作时，可以使用**两种工作模式**：
交互模式和非交互模式。交互模式，是连接到相应的Hypervisor上，然后输入一个命令得到一个返回结果，直到用户使用“quit”命令退出连接。非交互模式，是直接在命令行中在一个建立连接的URI之后添加需要执行的一个或多个命令，执行完成后将命令的输出结果返回到当前终端上，然后自动断开连接。

使用virsh的交互模式，命令行操作示例如下：

```
[root@kvm-host ~]# virsh -c qemu+ssh://root@192.168.158.31/system￼
root@192.168.158.31's password:￼
Welcome to virsh, the virtualization interactive terminal.￼
￼
Type:  'help' for help with commands￼
       'quit' to quit￼
￼
virsh # list￼
 Id    Name                           State￼
----------------------------------------------------￼
 3     rhel7u2-remote                 running￼
￼
virsh # quit
```

