[TOC]

# 1 veth设备的特点

- veth和其它的网络设备都一样，**一端**连接的是**内核协议栈**。
- veth设备是成对出现的，**另一端两个设备彼此相连**
- **一个设备**收到**协议栈的数据**发送请求后，会**将数据**发送到**另一个设备**上去。

```
+----------------------------------------------------------------+
|                                                                |
|       +------------------------------------------------+       |
|       |             Newwork Protocol Stack             |       |
|       +------------------------------------------------+       |
|              ↑               ↑               ↑                 |
|..............|...............|...............|.................|
|              ↓               ↓               ↓                 |
|        +----------+    +-----------+   +-----------+           |
|        |   eth0   |    |   veth0   |   |   veth1   |           |
|        +----------+    +-----------+   +-----------+           |
|192.168.1.11  ↑               ↑               ↑                 |
|              |               +---------------+                 |
|              |         192.168.2.11     192.168.2.1            |
+--------------|-------------------------------------------------+
               ↓
         Physical Network
```

上图中，我们给物理网卡eth0配置的IP为192.168.1.11， 而veth0和veth1的IP分别是192.168.2.11和192.168.2.1。

# 2 示例

我们通过示例的方式来一步一步的看看veth设备的特点。

## 2.1 只给一个veth设备配置IP

先通过**ip link命令**添加**veth0**和**veth1**，然后**配置veth0的IP**，并将两个设备都启动起来

```
dev@debian:~$ sudo ip link add veth0 type veth peer name veth1
dev@debian:~$ sudo ip addr add 192.168.2.11/24 dev veth0
dev@debian:~$ sudo ip link set veth0 up
dev@debian:~$ sudo ip link set veth1 up
```

这里**不给veth1设备**配置IP的原因就是想看看在**veth1没有IP**的情况下，**veth0**收到**协议栈的数据**后**会不会转发给veth1**。

ping一下192.168.2.1，由于veth1还没配置IP，所以肯定不通


