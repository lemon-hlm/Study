
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [参考](#参考)

<!-- /code_chunk_output -->

随着智能设备的广泛普及，这几年媒体上越来越多的出现关于“架构”“ARM vs x86”“芯片研发”的相关内容。很多消费者和爱好者面对这些以往不太常见的信息时就会迷惑甚至产生误解。其中一组比较容易被混淆的概念就是**CPU**、**架构**、**指令集**与**芯片**。本文试图用较浅显的文字阐明它们的关系与区别，纠正一些常见的错误认识与观点。

学过计算机基础知识的朋友都知道CPU的含义，亦即**中央处理器**，是负责计算机主要运算任务的组件。一般习惯把CPU比喻为人的大脑。而了解略深的用户会听说CPU有x86、ARM等分类，前者主要用于PC而后者主要用于手机平板等设备。那么这里的**x86**、**ARM**指的是什么呢？

**CPU执行计算任务**时都需要遵从**一定的规范**，程序在**被执行前**都需要先**翻译**为**CPU可以理解的语言**。这种**规范或语言**就是**指令集（ISA，Instruction Set Architecture**）。程序被按照**某种指令集的规范**翻译为**CPU可识别的底层代码**的过程叫做**编译（compile**）。**x86**、**ARM v8**、**MIPS**都是**指令集的代号**。**指令集**可以**被扩展**，如**x86**增加**64位支持**就有了**x86\-64**。厂商开发兼容某种指令集的CPU需要**指令集专利持有者授权**，典型例子如Intel授权AMD，使后者可以开发**兼容x86指令集**的CPU。

CPU的**基本组成单元**即为**核心（core**）。**多个核心**可以同时执行**多件计算任务**，前提是这些任务没有先后顺序。

**核心的实现方式**被称为**微架构（microarchitecture**）。微架构的设计**影响**核心可以达到的**最高频率**、核心在**一定频率**下能执行的**运算量**、一定工艺水平下核心的**能耗水平**等等。此外，**不同微架构**执行各类程序的**偏向**也**不同**，例如90年代末期Intel的P6微架构就在浮点类程序上表现优异，但在整数类应用中不如同频下的对手。

常见的代号如**Haswell**、**Cortex\-A15**等都是**微架构的称号**。注意**微架构**与**指令集**是两个概念：**指令集**是**CPU选择的语言**，而**微架构**是**具体的实现**。i7\-4770的核心是**Haswell微架构**，这种微架构**兼容x86指令集**。对于兼容ARM指令集的芯片来说这两个概念尤其容易混淆：**ARM公司**将自己研发的指令集叫做**ARM指令集**，同时它还**研发具体的微架构**如**Cortex系列**并对外授权。但是，**一款CPU**使用了**ARM指令集**不等于它就使用了**ARM研发的微架构！！！**。Intel、高通、苹果、Nvidia等厂商都自行开发了兼容ARM指令集的微架构，同时还有许多厂商使用ARM开发的微架构来制造CPU。通常，业界认为只有具备**独立的微架构研发能力**的企业才算具备了**CPU研发能力**，而是否使用自行研发的指令集无关紧要。微架构的研发也是IT产业技术含量最高的领域之一。

数年前国产龙芯CPU获得MIPS授权的消息曾引起一阵风波，龙芯相关负责人还曾出来解释。龙芯是兼容MIPS指令集，微架构部由中科院自主研发的CPU系列。过去中科院资金不足所以没有MIPS指令集授权，但是指令集的实现方式是公开的，因而中科院可以在研发时选择兼容该指令集。待资金充足买下授权后，龙芯就可以合法在市面销售。从这里我们可以知道，厂商研发CPU时并不需要获得指令集授权就可以获得指令集的相关资料与规范，指令集本身的技术含量并不是很高。获得授权主要是为了避免法律问题。然而微架构的设计细节是各家厂商绝对保密的，而且由于其技术复杂，即便获得相应文档也难以山寨。不同厂商的微架构设计水平也有较大差异，典型如Intel与AMD的对比，前者在最近几年明显技高一筹。

微架构研发完成，或者说核心研发完成，接下来就是将其组装为芯片了。过去的芯片仅仅包括CPU部分，如今大量的芯片集成了CPU、GPU、IO等多种不同的功能组件，此时这种芯片就不是传统意义上的“CPU”了。将各种功能组件组装为芯片的技术含量相比微架构研发来说是较低的，因而业界能做此类工作的企业也数量较多。

在PC时代，几大主要的CPU研发厂商都只是自己研制微架构自己用。到了智能设备时代，ARM公司的微架构授权模式兴起。ARM自己开发微架构后将它们上架出售，其他厂商可以拿这些核心组装为芯片来使用或销售。由于这种模式对第三方的技术能力要求很低，加上ARM的微架构在低功耗领域表现优异，这种模式获得了广泛成功。如果你发现某款芯片标明使用了Cortex系列核心，则一定是这种模式的产物。如前所述，仅仅从ARM购买微架构来组装芯片的厂商是不能被称作CPU研发企业的，这些芯片也不能被称为“xx厂商研发的CPU”。典型如华为的海思920、三星Exynos 5430，只能说是“使用ARM Cortex-A15核心的芯片”。但是如果一款兼容ARM指令集的芯片使用了厂商自主研发的微架构情况就不同了。高通骁龙800、苹果A7就是这样的例子--它们分别使用了高通、苹果自主研发的CPU。

随着智能设备市场不断扩大，ARM阵营也不断壮大。占领智能设备领域后，ARM阵营开始进入PC、服务器与高性能计算领域。先是ARM发布了ARM v8 64位指令集规范，接着是各大厂商纷纷开始研发基于ARM v8的高性能微架构。有人会问，ARM指令集不是为低功耗设备研发的吗？怎么现在又开始做高性能CPU了呢？多年以前这样的怀疑是很有道理的，因为彼时不同指令集对微架构的影响还比较大，ARM适合低功耗，x86适合PC，Power适合小型机……这类区分是存在的。但是随着技术进步，指令集对微架构的影响已经小到可以忽略，任何指令集都可以做出适合不同领域的优秀微架构来。因此用户看到x86指令集的手机cpu或是ARM指令集的服务器CPU都无需惊讶，这是技术发展的自然结果。

那么，现在各家CPU研发厂商选择指令集的标准又是什么呢？业界除了x86和ARM、MIPS，其实还有一大堆各种各样的指令集。比如小型主机领域的Sparc、Alpha、Power等。国内几家研CPU的科研机构就分别选择了x86、MIPS、Sparc、Alpha、ARM指令集，早年甚至有机构选择Intel没落的Itanium使用的EPIC指令集的。一般来说大家倾向于选择软件生态较好的指令集--前面说过，软件必须编译后才能在某种指令集平台上运行，而编译是很复杂的事情，绝大多数闭源软件仅仅会对少数一两个平台编译。因而支持某种指令集的软件应用越多，这种指令集也就越有市场优势--新开发的微架构只需要兼容某种指令集，那么就可以很容易运行大量为其开发的软件。早年因为微软的强势与Wintel联盟的推动，x86指令集成了最受欢迎的角色，帮助Intel用彼时性能相对落后的微架构在PC平台挤跑了一众对手。后PC时代由于苹果谷歌的两大操作系统平台的推动，ARM指令集又取得了绝对的市场优势。但对于新的CPU研发单位来说，他们想获得热门指令集的兼容授权是很困难的事情。以前x86与ARM的指令集授权是拿钱买不到的，想要得到都需要进行高水平专利交换。拿到x86授权的几家厂商要么是拿的早（AMD、Cyrix、IDT），要么是有高水平技术与Intel交易（Transmeta，以功耗控制技术同Intel交易）。后来Nvidia想要研发自己的CPU，找Intel软磨硬泡后者就是不给，搞得Nvidia相当无奈。国内的研发单位当年开始研究时自知不可能拿到x86授权，于是各自去找关系好些的其他授权方解决问题了。ARM这边也一直对指令集授权卡的很死，之前只有高通、博通和Intel得到，也是通过技术交换的形式。08年苹果乔帮主被Intel甩脸色后决定自己搞CPU，最后也拿到了ARM的许可，想来彼时老乔也是威逼利诱，硬是让ARM屈服了（毕竟指令集多授权一家就多个对手啊）。后来ARM对指令集授权也放松了，去年三星与华为也分别得到了授权，他们的自研CPU预计也将在未来一两年面世。

本文总结下来的内容很简单：指令集与微架构是不同的概念，不可混淆；CPU研发指的是微架构研发；如今指令集不再有“最适合领域”的说法。希望这篇文章能帮助被这些问题困扰的朋友，也希望媒体在提及这些概念时多做一些科普与澄清。

也就是说: 说cpu就基本等于说微架构

# 参考

https://zhuanlan.zhihu.com/p/19893066