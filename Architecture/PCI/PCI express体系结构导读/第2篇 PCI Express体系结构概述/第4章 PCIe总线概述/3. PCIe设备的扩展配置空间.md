[TOC]

本书在第2.3.2节讲述了**PCI设备**使用的**基本配置空间**。这个基本配置空间共由**64个字节**组成，其地址范围为**0x00\~0x3F**，这**64个字节**是**所有PCI设备必须支持(！！！PCI设备**)的。事实上，**许多PCI设备**也**仅支持这64个配置寄存器**。

此外**PCI/PCI\-X和PCIe设备**还**扩展了0x40\~0xFF(！！！**)这段**配置空间**，在这段空间**主要存放**一些**与MSI或者MSI\-X中断机制**和**电源管理相关的Capability结构**。其中所有**能够提交中断请求**的PCIe设备，**必须支持MSI或者MSI\-X Capability结构(！！！**)。

**PCIe设备**还支持**0x100\~0xFFF(！！！**)这段扩展配置空间。PCIe设备使用的扩展配置空间**最大为4KB**，在PCIe总线的扩展配置空间中，存放PCIe设备所独有的一些Capability结构，而PCI设备不能使用这段空间。

在x86处理器中，使用CONFIG\_ADDRESS寄存器与CONFIG\_DATA寄存器访问PCIe配置空间的0x00\~0xFF，而使用ECAM方式访问0x000\~0xFFF这段空间；而在PowerPC处理器中，可以使用CFG\_ADDR和CFG\_DATA寄存器访问0x000\~0xFFF，详见第2.2节。

PCI-X和PCIe总线规范要求其设备必须支持Capabilities结构。在PCI总线的基本配置空间中，包含一个Capabilities Pointer寄存器，该寄存器存放Capabilities结构链表的头指针。在一个PCIe设备中，可能含有多个Capability结构，这些寄存器组成一个链表，其结构如图4‑14所示。