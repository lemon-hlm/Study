a、AggregateCoreFilter的cpu_allocation_ratio metadata key

使用：

```
nova aggregate-set-metadata 1 cpu_allocation_ratio=2.0
```

b、compute node的配置文件nova.conf支持cpu_allocation_ratio参数设置

c、原本的controller node nova.conf的cpu_allocation_ratio参数设置

优先级：a > b > c

为什么是这样的优先级呢，下面看代码：

```python
[nova/scheduler/filters/core_filter.py]
class AggregateCoreFilter(BaseCoreFilter):
    """AggregateCoreFilter with per-aggregate CPU subscription flag.

    Fall back to global cpu_allocation_ratio if no per-aggregate setting found.
    """

    def _get_cpu_allocation_ratio(self, host_state, spec_obj):
        aggregate_vals = utils.aggregate_values_from_key(
            host_state,
            'cpu_allocation_ratio')
        try:
            # host_state是从nova数据库中compute_node表来的
            ratio = utils.validate_num_values(
                aggregate_vals, host_state.cpu_allocation_ratio, cast_to=float)
        except ValueError as e:
            LOG.warning("Could not decode cpu_allocation_ratio: '%s'", e)
            ratio = host_state.cpu_allocation_ratio

        return ratio

[nova/scheduler/filters/utils.py]
def aggregate_values_from_key(host_state, key_name):
    """Returns a set of values based on a metadata key for a specific host."""
    aggrlist = host_state.aggregates
    return {aggr.metadata[key_name]
              for aggr in aggrlist
              if key_name in aggr.metadata
              }
```

